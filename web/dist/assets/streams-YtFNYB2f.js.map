{"version":3,"file":"streams-YtFNYB2f.js","sources":["../../js/components/preact/StreamDeleteModal.js","../../js/components/preact/StreamsView.jsx","../../js/pages/streams-page.jsx"],"sourcesContent":["/**\n * LightNVR Web Interface Stream Delete Modal Component\n * Preact component for the stream delete modal\n */\n\nimport { html } from '../../html-helper.js';\nimport { useState } from 'preact/hooks';\n\n/**\n * StreamDeleteModal component\n * @param {Object} props Component props\n * @param {string} props.streamId ID of the stream to delete\n * @param {string} props.streamName Name of the stream to display\n * @param {Function} props.onClose Function to call when the modal is closed\n * @param {Function} props.onDisable Function to call when the disable button is clicked\n * @param {Function} props.onDelete Function to call when the delete button is clicked\n * @returns {JSX.Element} StreamDeleteModal component\n */\nexport function StreamDeleteModal({ streamId, streamName, onClose, onDisable, onDelete }) {\n  const [isConfirmDelete, setIsConfirmDelete] = useState(false);\n  \n  // Show delete confirmation step\n  const showDeleteConfirmation = () => {\n    setIsConfirmDelete(true);\n  };\n  \n  // Handle disable stream\n  const handleDisable = () => {\n    onDisable(streamId);\n    onClose();\n  };\n  \n  // Handle delete stream\n  const handleDelete = () => {\n    onDelete(streamId);\n    onClose();\n  };\n  \n  return html`\n    <div class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 transition-opacity duration-300\">\n      <div class=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full\">\n        <div class=\"flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700\">\n          <h3 class=\"text-lg font-medium\">${isConfirmDelete ? 'Confirm Permanent Deletion' : 'Stream Actions'}</h3>\n          <span class=\"text-2xl cursor-pointer\" onClick=${onClose}>×</span>\n        </div>\n        \n        <div class=\"p-6\">\n          ${!isConfirmDelete ? html`\n            <div class=\"mb-6\">\n              <h4 class=\"text-lg font-medium mb-2\">What would you like to do with \"${streamName}\"?</h4>\n              <p class=\"text-gray-600 dark:text-gray-400 mb-4\">\n                Please choose one of the following options:\n              </p>\n              \n              <div class=\"space-y-4\">\n                <div class=\"p-4 border border-yellow-200 bg-yellow-50 dark:bg-yellow-900/20 dark:border-yellow-900/30 rounded-lg\">\n                  <h5 class=\"font-medium text-yellow-800 dark:text-yellow-500 mb-2\">Disable Stream (Soft Delete)</h5>\n                  <p class=\"text-gray-600 dark:text-gray-400 mb-2\">\n                    This option will disable the stream but keep its configuration in the database. You can re-enable it later.\n                  </p>\n                  <ul class=\"list-disc list-inside text-sm text-gray-600 dark:text-gray-400 mb-3\">\n                    <li>Stream will stop processing</li>\n                    <li>Live streaming will be disabled</li>\n                    <li>Recording will be disabled</li>\n                    <li>Audio recording will be disabled</li>\n                    <li>Detection-based recording will be disabled</li>\n                    <li>Configuration is preserved</li>\n                    <li>Existing recordings are kept</li>\n                    <li>Can be re-enabled later</li>\n                  </ul>\n                  <button \n                    class=\"w-full px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700 transition-colors focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800\"\n                    onClick=${handleDisable}\n                  >\n                    Disable Stream\n                  </button>\n                </div>\n                \n                <div class=\"p-4 border border-red-200 bg-red-50 dark:bg-red-900/20 dark:border-red-900/30 rounded-lg\">\n                  <h5 class=\"font-medium text-red-800 dark:text-red-500 mb-2\">Delete Stream (Permanent)</h5>\n                  <p class=\"text-gray-600 dark:text-gray-400 mb-2\">\n                    This option will permanently delete the stream configuration from the database. This action cannot be undone.\n                  </p>\n                  <ul class=\"list-disc list-inside text-sm text-gray-600 dark:text-gray-400 mb-3\">\n                    <li>Stream will be completely removed</li>\n                    <li>Configuration is deleted</li>\n                    <li>Recordings remain accessible</li>\n                    <li>Cannot be recovered</li>\n                  </ul>\n                  <button \n                    class=\"w-full px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800\"\n                    onClick=${showDeleteConfirmation}\n                  >\n                    Delete Stream\n                  </button>\n                </div>\n              </div>\n            </div>\n          ` : html`\n            <div class=\"mb-6\">\n              <div class=\"flex items-center justify-center mb-4 text-red-600 dark:text-red-500\">\n                <svg class=\"w-12 h-12\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <path fill-rule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clip-rule=\"evenodd\"></path>\n                </svg>\n              </div>\n              <h4 class=\"text-lg font-medium mb-2 text-center\">Are you sure you want to permanently delete \"${streamName}\"?</h4>\n              <p class=\"text-gray-600 dark:text-gray-400 mb-4 text-center\">\n                This action cannot be undone. The stream configuration will be permanently removed from the database.\n              </p>\n            </div>\n            \n            <div class=\"flex justify-center space-x-3\">\n              <button \n                class=\"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800\"\n                onClick=${() => setIsConfirmDelete(false)}\n              >\n                Cancel\n              </button>\n              <button \n                class=\"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800\"\n                onClick=${handleDelete}\n              >\n                Yes, Delete Permanently\n              </button>\n            </div>\n          `}\n        </div>\n      </div>\n    </div>\n  `;\n}\n","/**\n * LightNVR Web Interface StreamsView Component\n * React component for the streams page\n */\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { showStatusMessage } from './UI.js';\nimport { ContentLoader } from './LoadingIndicator.js';\nimport { StreamDeleteModal } from './StreamDeleteModal.js';\nimport {\n  useQuery,\n  useMutation,\n  useQueryClient,\n  usePostMutation,\n  usePutMutation,\n  useDeleteMutation,\n  fetchJSON\n} from '../../query-client.js';\n\n/**\n * StreamsView component\n * @returns {JSX.Element} StreamsView component\n */\nexport function StreamsView() {\n  const queryClient = useQueryClient();\n\n  // State for streams data\n  const [modalVisible, setModalVisible] = useState(false);\n  const [onvifModalVisible, setOnvifModalVisible] = useState(false);\n  const [showCustomNameInput, setShowCustomNameInput] = useState(false);\n  const [isAddingStream, setIsAddingStream] = useState(false);\n  const [discoveredDevices, setDiscoveredDevices] = useState([]);\n  const [deviceProfiles, setDeviceProfiles] = useState([]);\n  const [selectedDevice, setSelectedDevice] = useState(null);\n  const [selectedProfile, setSelectedProfile] = useState(null);\n  const [customStreamName, setCustomStreamName] = useState('');\n  const [onvifCredentials, setOnvifCredentials] = useState({ username: '', password: '' });\n  const [isDiscovering, setIsDiscovering] = useState(false);\n  const [isLoadingProfiles, setIsLoadingProfiles] = useState(false);\n\n  // Fetch streams data\n  const {\n    data: streamsResponse = [],\n    isLoading,\n    error\n  } = useQuery(['streams'], '/api/streams', {\n    timeout: 10000,\n    retries: 2,\n    retryDelay: 1000\n  });\n\n  // Fetch detection models\n  const {\n    data: detectionModelsData\n  } = useQuery(['detectionModels'], '/api/detection/models', {\n    timeout: 5000,\n    retries: 1,\n    retryDelay: 1000\n  });\n\n  // Process the response to handle both array and object formats\n  const streams = Array.isArray(streamsResponse) ? streamsResponse : (streamsResponse.streams || []);\n\n  // Log streams data for debugging\n  console.log('API Response:', streamsResponse);\n\n  // Log streams data for debugging\n  console.log('Streams data:', streams);\n  console.log('hasData:', streams && streams.length > 0);\n\n  // Default stream state\n  const [currentStream, setCurrentStream] = useState({\n    name: '',\n    url: '',\n    enabled: true,\n    streamingEnabled: true,\n    width: 1280,\n    height: 720,\n    fps: 15,\n    codec: 'h264',\n    protocol: '0',\n    priority: '5',\n    segment: 30,\n    record: true,\n    recordAudio: true,\n    detectionEnabled: false,\n    detectionModel: '',\n    detectionThreshold: 50,\n    detectionInterval: 10,\n    preBuffer: 10,\n    postBuffer: 30\n  });\n  const [isEditing, setIsEditing] = useState(false);\n\n  // State for delete modal\n  const [deleteModalVisible, setDeleteModalVisible] = useState(false);\n  const [streamToDelete, setStreamToDelete] = useState(null);\n\n  // Compute hasData from streams\n  const hasData = streams && streams.length > 0;\n\n  // Extract detection models from query result\n  const detectionModels = detectionModelsData?.models || [];\n\n  // Mutations for saving stream (create or update)\n  const createStreamMutation = usePostMutation(\n    '/api/streams',\n    {\n      timeout: 15000,\n      retries: 1,\n      retryDelay: 1000\n    },\n    {\n      onSuccess: () => {\n        showStatusMessage('Stream added successfully');\n        closeModal();\n        // Invalidate and refetch streams data\n        queryClient.invalidateQueries({ queryKey: ['streams'] });\n      },\n      onError: (error) => {\n        showStatusMessage(`Error adding stream: ${error.message}`, 5000, 'error');\n      }\n    }\n  );\n\n  const updateStreamMutation = useMutation({\n    mutationFn: async (data) => {\n      const { streamName, ...streamData } = data;\n      const url = `/api/streams/${encodeURIComponent(streamName)}`;\n      return await fetchJSON(url, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(streamData),\n        timeout: 15000,\n        retries: 1,\n        retryDelay: 1000\n      });\n    },\n    onSuccess: () => {\n      showStatusMessage('Stream updated successfully');\n      closeModal();\n      // Invalidate and refetch streams data\n      queryClient.invalidateQueries({ queryKey: ['streams'] });\n    },\n    onError: (error) => {\n      showStatusMessage(`Error updating stream: ${error.message}`, 5000, 'error');\n    }\n  });\n\n  // Helper function to use the appropriate mutation based on editing state\n  const saveStreamMutation = {\n    mutate: (streamData, options) => {\n      if (isEditing) {\n        // For PUT requests, we need to include the streamName parameter\n        updateStreamMutation.mutate({\n          ...streamData,\n          streamName: streamData.name\n        }, options);\n      } else {\n        createStreamMutation.mutate(streamData, options);\n      }\n    }\n  };\n\n  // Mutation for testing stream connection\n  const testStreamMutation = usePostMutation(\n    '/api/streams/test',\n    {\n      timeout: 20000,\n      retries: 1,\n      retryDelay: 2000\n    },\n    {\n      onMutate: () => {\n        showStatusMessage('Testing stream connection...');\n      },\n      onSuccess: (data) => {\n        if (data.success) {\n          showStatusMessage('Stream connection successful!', 3000, 'success');\n        } else {\n          showStatusMessage(`Stream connection failed: ${data.message}`, 5000, 'error');\n        }\n      },\n      onError: (error) => {\n        showStatusMessage(`Error testing stream: ${error.message}`, 5000, 'error');\n      }\n    }\n  );\n\n  // Mutation for deleting stream\n  const deleteStreamMutation = useMutation({\n    mutationFn: async (params) => {\n      const { streamId } = params;\n      const url = `/api/streams/${encodeURIComponent(streamId)}?permanent=true`;\n      return await fetchJSON(url, {\n        method: 'DELETE',\n        timeout: 15000,\n        retries: 1,\n        retryDelay: 1000\n      });\n    },\n    onSuccess: () => {\n      showStatusMessage('Stream successfully deleted.');\n      closeDeleteModal();\n      // Invalidate and refetch streams data\n      queryClient.invalidateQueries({ queryKey: ['streams'] });\n    },\n    onError: (error) => {\n      showStatusMessage(`Error deleting stream: ${error.message}`, 5000, 'error');\n    }\n  });\n\n  const disableStreamMutation = useMutation({\n    mutationFn: async (params) => {\n      const { streamId } = params;\n      const url = `/api/streams/${encodeURIComponent(streamId)}`;\n      return await fetchJSON(url, {\n        method: 'DELETE',\n        timeout: 15000,\n        retries: 1,\n        retryDelay: 1000\n      });\n    },\n    onSuccess: () => {\n      showStatusMessage('Stream successfully disabled.');\n      closeDeleteModal();\n      // Invalidate and refetch streams data\n      queryClient.invalidateQueries({ queryKey: ['streams'] });\n    },\n    onError: (error) => {\n      showStatusMessage(`Error disabling stream: ${error.message}`, 5000, 'error');\n    }\n  });\n\n  // Handle form submission\n  const handleSubmit = (e) => {\n    e.preventDefault();\n\n    // Prepare stream data for API\n    const streamData = {\n      name: currentStream.name,\n      url: currentStream.url,\n      enabled: currentStream.enabled,\n      streaming_enabled: currentStream.streamingEnabled,\n      width: parseInt(currentStream.width, 10),\n      height: parseInt(currentStream.height, 10),\n      fps: parseInt(currentStream.fps, 10),\n      codec: currentStream.codec,\n      protocol: parseInt(currentStream.protocol, 10),\n      priority: parseInt(currentStream.priority, 10),\n      segment_duration: parseInt(currentStream.segment, 10),\n      record: currentStream.record,\n      detection_based_recording: currentStream.detectionEnabled,\n      detection_model: currentStream.detectionModel,\n      detection_threshold: parseInt(currentStream.detectionThreshold, 10),\n      detection_interval: parseInt(currentStream.detectionInterval, 10),\n      pre_detection_buffer: parseInt(currentStream.preBuffer, 10),\n      post_detection_buffer: parseInt(currentStream.postBuffer, 10),\n      record_audio: currentStream.recordAudio\n    };\n\n    // When editing, set is_deleted to false to allow undeleting soft-deleted streams\n    if (isEditing) {\n      streamData.is_deleted = false;\n    }\n\n    // Use mutation to save stream\n    saveStreamMutation.mutate(streamData);\n  };\n\n  // Save stream (wrapper for handleSubmit to use in onClick)\n  const saveStream = (e) => {\n    handleSubmit(e);\n  };\n\n  // Test stream connection\n  const testStreamConnection = () => {\n    testStreamMutation.mutate({\n      url: currentStream.url,\n      protocol: parseInt(currentStream.protocol, 10)\n    });\n  };\n\n  // Open delete modal\n  const openDeleteModal = (stream) => {\n    setStreamToDelete(stream);\n    setDeleteModalVisible(true);\n  };\n\n  // Close delete modal\n  const closeDeleteModal = () => {\n    setDeleteModalVisible(false);\n    setStreamToDelete(null);\n  };\n\n  // Open add stream modal\n  const openAddStreamModal = () => {\n    setCurrentStream({\n      name: '',\n      url: '',\n      enabled: true,\n      streamingEnabled: true,\n      width: 1280,\n      height: 720,\n      fps: 15,\n      codec: 'h264',\n      protocol: '0',\n      priority: '5',\n      segment: 30,\n      record: true,\n      recordAudio: true,\n      detectionEnabled: false,\n      detectionModel: '',\n      detectionThreshold: 50,\n      detectionInterval: 10,\n      preBuffer: 10,\n      postBuffer: 30\n    });\n    setIsEditing(false);\n    setModalVisible(true);\n  };\n\n  // Open edit stream modal\n  const openEditStreamModal = async (streamId) => {\n    try {\n      // Use queryClient to fetch stream details\n      const stream = await queryClient.fetchQuery({\n        queryKey: ['stream', streamId],\n        queryFn: async () => {\n          const response = await fetch(`/api/streams/${encodeURIComponent(streamId)}`);\n          if (!response.ok) {\n            throw new Error(`HTTP error ${response.status}`);\n          }\n          return response.json();\n        },\n        staleTime: 10000 // 10 seconds\n      });\n\n      setCurrentStream({\n        ...stream,\n        // Convert numeric values to strings for form inputs\n        width: stream.width || 1280,\n        height: stream.height || 720,\n        fps: stream.fps || 15,\n        protocol: stream.protocol?.toString() || '0',\n        priority: stream.priority?.toString() || '5',\n        segment: stream.segment_duration || 30,\n        detectionThreshold: stream.detection_threshold || 50,\n        detectionInterval: stream.detection_interval || 10,\n        preBuffer: stream.pre_detection_buffer || 10,\n        postBuffer: stream.post_detection_buffer || 30,\n        // Map API fields to form fields\n        streamingEnabled: stream.streaming_enabled !== undefined ? stream.streaming_enabled : true,\n        isOnvif: stream.is_onvif !== undefined ? stream.is_onvif : false,\n        detectionEnabled: stream.detection_based_recording || false,\n        detectionModel: stream.detection_model || '',\n        recordAudio: stream.record_audio !== undefined ? stream.record_audio : true\n      });\n      setIsEditing(true);\n      setModalVisible(true);\n    } catch (error) {\n      console.error('Error loading stream details:', error);\n      showStatusMessage('Error loading stream details: ' + error.message);\n    }\n  };\n\n  // Close modal\n  const closeModal = () => {\n    setModalVisible(false);\n  };\n\n  // Open ONVIF discovery modal\n  const openOnvifModal = () => {\n    setDiscoveredDevices([]);\n    setDeviceProfiles([]);\n    setSelectedDevice(null);\n    setSelectedProfile(null);\n    setCustomStreamName('');\n    setOnvifModalVisible(true);\n  };\n\n  // Close ONVIF modal\n  const closeOnvifModal = () => {\n    setOnvifModalVisible(false);\n  };\n\n  // Handle form input change\n  const handleInputChange = (e) => {\n    const { name, value, type, checked } = e.target;\n    setCurrentStream(prev => ({\n      ...prev,\n      [name]: type === 'checkbox' ? checked : value\n    }));\n  };\n\n  // Disable stream (soft delete)\n  const disableStream = (streamId) => {\n    disableStreamMutation.mutate({\n      streamId,\n    });\n  };\n\n  // Delete stream (permanent)\n  const deleteStream = (streamId) => {\n    deleteStreamMutation.mutate({\n      streamId,\n    });\n  };\n\n  // Handle ONVIF credential input change\n  const handleCredentialChange = (e) => {\n    const { name, value } = e.target;\n    setOnvifCredentials(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n\n  // Handle threshold change\n  const handleThresholdChange = (e) => {\n    const value = e.target.value;\n    setCurrentStream(prev => ({\n      ...prev,\n      detectionThreshold: value\n    }));\n  };\n\n  // Load detection models\n  const loadDetectionModels = () => {\n    queryClient.invalidateQueries({ queryKey: ['detectionModels'] });\n  };\n\n  // ONVIF discovery mutation\n  const onvifDiscoveryMutation = usePostMutation(\n    '/api/onvif/discovery/discover',\n    {\n      timeout: 120000,\n      retries: 0\n    },\n    {\n      onMutate: () => {\n        setIsDiscovering(true);\n      },\n      onSuccess: (data) => {\n        setDiscoveredDevices(data.devices || []);\n        setIsDiscovering(false);\n      },\n      onError: (error) => {\n        showStatusMessage(`Error discovering ONVIF devices: ${error.message}`, 5000, 'error');\n        setIsDiscovering(false);\n      }\n    }\n  );\n\n  // Get device profiles mutation\n  const getDeviceProfilesMutation = useMutation({\n    mutationFn: ({ device, credentials }) => {\n      setIsLoadingProfiles(true);\n\n      // Make a simple GET request\n      return fetch('/api/onvif/device/profiles', {\n        method: 'GET',\n        headers: {\n          'X-Device-URL': `http://${device.ip_address}/onvif/device_service`,\n          'X-Username': credentials.username,\n          'X-Password': credentials.password\n        }\n      }).then(response => {\n        if (!response.ok) {\n          throw new Error(`HTTP error ${response.status}`);\n        }\n        return response.json();\n      });\n    },\n    onSuccess: (data) => {\n      setDeviceProfiles(data.profiles || []);\n      setIsLoadingProfiles(false);\n    },\n    onError: (error) => {\n      showStatusMessage(`Error loading device profiles: ${error.message}`, 5000, 'error');\n      setIsLoadingProfiles(false);\n    }\n  });\n\n  // Test ONVIF connection mutation\n  const testOnvifConnectionMutation = usePostMutation(\n    '/api/onvif/device/test',\n    {\n      timeout: 15000,\n      retries: 0\n    },\n    {\n      onMutate: () => {\n        setIsLoadingProfiles(true);\n      },\n      onSuccess: (data, variables) => {\n        if (data.success) {\n          showStatusMessage('Connection successful!', 3000, 'success');\n          // The device object is no longer passed directly in variables\n          // We need to use the selectedDevice state instead\n          if (selectedDevice) {\n            getDeviceProfiles(selectedDevice);\n          }\n        } else {\n          showStatusMessage(`Connection failed: ${data.message}`, 5000, 'error');\n          setIsLoadingProfiles(false);\n        }\n      },\n      onError: (error) => {\n        showStatusMessage(`Error testing connection: ${error.message}`, 5000, 'error');\n        setIsLoadingProfiles(false);\n      }\n    }\n  );\n\n\n\n  // Submit ONVIF device\n  const submitOnvifDevice = () => {\n    if (!selectedDevice || !selectedProfile || !customStreamName.trim()) {\n      showStatusMessage('Missing required information', 5000, 'error');\n      return;\n    }\n\n    setIsAddingStream(true);\n\n    // Prepare stream data\n    const streamData = {\n      name: customStreamName.trim(),\n      url: selectedProfile.stream_uri, // Use stream_uri instead of url\n      enabled: true,\n      streaming_enabled: true,\n      width: selectedProfile.width,\n      height: selectedProfile.height,\n      fps: selectedProfile.fps || 15,\n      codec: selectedProfile.encoding === 'H264' ? 'h264' : 'h265',\n      protocol: '0', // TCP\n      priority: '5', // Medium\n      segment_duration: 30,\n      record: true,\n      record_audio: true,\n      is_onvif: true\n    };\n\n    // Log the stream data for debugging\n    console.log('Adding ONVIF stream with data:', streamData);\n\n    // Use mutation to save stream\n    saveStreamMutation.mutate(streamData, {\n      onSuccess: () => {\n        setIsAddingStream(false);\n        setShowCustomNameInput(false);\n        setOnvifModalVisible(false);\n      },\n      onError: () => {\n        setIsAddingStream(false);\n      },\n      isEditing: false,\n    });\n  };\n\n  // Start ONVIF discovery\n  const startOnvifDiscovery = () => {\n    onvifDiscoveryMutation.mutate({});\n  };\n\n  // Get ONVIF device profiles\n  const getDeviceProfiles = (device) => {\n    setSelectedDevice(device);\n    setDeviceProfiles([]);\n    getDeviceProfilesMutation.mutate({\n      device,\n      credentials: onvifCredentials\n    });\n  };\n\n  // Handle custom stream name change\n  const handleStreamNameChange = (e) => {\n    setCustomStreamName(e.target.value);\n  };\n\n  // Add ONVIF device as stream with selected profile\n  const addOnvifDeviceAsStream = (profile) => {\n    setSelectedProfile(profile);\n    setCustomStreamName(`${selectedDevice.name || 'ONVIF'}_${profile.name || 'Stream'}`);\n    setShowCustomNameInput(true);\n  };\n\n  // Test ONVIF connection\n  const testOnvifConnection = (device) => {\n    // Store the selected device first\n    setSelectedDevice(device);\n\n    // Then make the API call\n    testOnvifConnectionMutation.mutate({\n      url: `http://${device.ip_address}/onvif/device_service`,\n      username: onvifCredentials.username,\n      password: onvifCredentials.password\n    });\n  };\n\n  return (\n    <section id=\"streams-page\" className=\"page\">\n      <div className=\"page-header flex justify-between items-center mb-4 p-4 bg-white dark:bg-gray-800 rounded-lg shadow\">\n        <h2 className=\"text-xl font-bold\">Streams</h2>\n        <div className=\"controls flex space-x-2\">\n          <button\n              id=\"discover-onvif-btn\"\n              className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800\"\n              onClick={() => setOnvifModalVisible(true)}\n          >\n            Discover ONVIF Cameras\n          </button>\n          <button\n              id=\"add-stream-btn\"\n              className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800\"\n              onClick={openAddStreamModal}\n          >\n            Add Stream\n          </button>\n        </div>\n      </div>\n\n      <ContentLoader\n          isLoading={isLoading}\n          hasData={hasData}\n          loadingMessage=\"Loading streams...\"\n          emptyMessage=\"No streams configured yet. Click 'Add Stream' to create one.\"\n      >\n        <div className=\"streams-container bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden\">\n          <div className=\"overflow-x-auto\">\n            <table id=\"streams-table\" className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n              <thead className=\"bg-gray-50 dark:bg-gray-700\">\n              <tr>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Name</th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">URL</th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Resolution</th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">FPS</th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Recording</th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Actions</th>\n              </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700\">\n              {streams.map(stream => (\n                <tr key={stream.name} className=\"hover:bg-gray-50 dark:hover:bg-gray-700\">\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"flex items-center\">\n                      <span className={`status-indicator w-2 h-2 rounded-full mr-2 ${stream.enabled ? 'bg-green-500' : 'bg-red-500'}`}></span>\n                      {stream.name}\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">{stream.url}</td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">{stream.width}x{stream.height}</td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">{stream.fps}</td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    {stream.record ? 'Enabled' : 'Disabled'}\n                    {stream.detection_based_recording ? ' (Detection)' : ''}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"flex space-x-2\">\n                      <button\n                          className=\"p-1 rounded-full text-blue-600 hover:bg-blue-100 dark:text-blue-400 dark:hover:bg-blue-900 focus:outline-none\"\n                          onClick={() => openEditStreamModal(stream.name)}\n                          title=\"Edit\"\n                      >\n                        <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\">\n                          <path d=\"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z\"></path>\n                        </svg>\n                      </button>\n                      <button\n                          className=\"p-1 rounded-full text-red-600 hover:bg-red-100 dark:text-red-400 dark:hover:bg-red-900 focus:outline-none\"\n                          onClick={() => openDeleteModal(stream)}\n                          title=\"Delete\"\n                      >\n                        <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\">\n                          <path fillRule=\"evenodd\" d=\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z\" clipRule=\"evenodd\"></path>\n                        </svg>\n                      </button>\n                    </div>\n                  </td>\n                </tr>\n              ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </ContentLoader>\n\n      {deleteModalVisible && streamToDelete && (\n        <StreamDeleteModal\n            streamId={streamToDelete.name}\n            streamName={streamToDelete.name}\n            onClose={closeDeleteModal}\n            onDisable={disableStream}\n            onDelete={deleteStream}\n        />\n      )}\n\n      {modalVisible && (\n        <div id=\"stream-modal\" className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 transition-opacity duration-300\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto\">\n            <div className=\"flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700\">\n              <h3 className=\"text-lg font-medium\">{isEditing ? 'Edit Stream' : 'Add Stream'}</h3>\n              <span className=\"text-2xl cursor-pointer\" onClick={closeModal}>×</span>\n            </div>\n            <div className=\"p-4\">\n              <form id=\"stream-form\" className=\"space-y-4\">\n                <div className=\"form-group\">\n                  <label for=\"stream-name\" className=\"block text-sm font-medium mb-1\">Name</label>\n                  <input\n                      type=\"text\"\n                      id=\"stream-name\"\n                      name=\"name\"\n                      className={`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white ${isEditing ? 'bg-gray-100 dark:bg-gray-800' : ''}`}\n                      value={currentStream.name}\n                      onChange={handleInputChange}\n                      disabled={isEditing}\n                      required\n                  />\n                </div>\n                <div className=\"form-group\">\n                  <label for=\"stream-url\" className=\"block text-sm font-medium mb-1\">URL</label>\n                  <input\n                      type=\"text\"\n                      id=\"stream-url\"\n                      name=\"url\"\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\n                      placeholder=\"rtsp://example.com/stream\"\n                      value={currentStream.url}\n                      onChange={handleInputChange}\n                      required\n                  />\n                </div>\n                <div className=\"form-group flex items-center\">\n                  <input\n                      type=\"checkbox\"\n                      id=\"stream-enabled\"\n                      name=\"enabled\"\n                      className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      checked={currentStream.enabled}\n                      onChange={handleInputChange}\n                  />\n                  <label for=\"stream-enabled\" className=\"ml-2 block text-sm\">Stream Active</label>\n                  <span className=\"ml-2 text-xs text-gray-500 dark:text-gray-400\">Enable/disable all stream processing</span>\n                </div>\n                <div className=\"form-group flex items-center\">\n                  <input\n                      type=\"checkbox\"\n                      id=\"stream-streaming-enabled\"\n                      name=\"streamingEnabled\"\n                      className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      checked={currentStream.streamingEnabled}\n                      onChange={handleInputChange}\n                  />\n                  <label for=\"stream-streaming-enabled\" className=\"ml-2 block text-sm\">Live View Enabled</label>\n                  <span className=\"ml-2 text-xs text-gray-500 dark:text-gray-400\">Enable/disable live viewing in browser</span>\n                </div>\n                <div className=\"form-group flex items-center\">\n                  <input\n                      type=\"checkbox\"\n                      id=\"stream-is-onvif\"\n                      name=\"isOnvif\"\n                      className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      checked={currentStream.isOnvif}\n                      onChange={handleInputChange}\n                  />\n                  <label for=\"stream-is-onvif\" className=\"ml-2 block text-sm\">ONVIF Camera</label>\n                  <span className=\"ml-2 text-xs text-gray-500 dark:text-gray-400\">Mark this stream as an ONVIF camera for special handling</span>\n                </div>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div className=\"form-group\">\n                    <label for=\"stream-width\" className=\"block text-sm font-medium mb-1\">Width</label>\n                    <input\n                        type=\"number\"\n                        id=\"stream-width\"\n                        name=\"width\"\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\n                        min=\"320\"\n                        max=\"1920\"\n                        value={currentStream.width}\n                        onChange={handleInputChange}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label for=\"stream-height\" className=\"block text-sm font-medium mb-1\">Height</label>\n                    <input\n                        type=\"number\"\n                        id=\"stream-height\"\n                        name=\"height\"\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\n                        min=\"240\"\n                        max=\"1080\"\n                        value={currentStream.height}\n                        onChange={handleInputChange}\n                    />\n                  </div>\n                </div>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                  <div className=\"form-group\">\n                    <label for=\"stream-fps\" className=\"block text-sm font-medium mb-1\">FPS</label>\n                    <input\n                        type=\"number\"\n                        id=\"stream-fps\"\n                        name=\"fps\"\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\n                        min=\"1\"\n                        max=\"30\"\n                        value={currentStream.fps}\n                        onChange={handleInputChange}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label for=\"stream-codec\" className=\"block text-sm font-medium mb-1\">Codec</label>\n                    <select\n                        id=\"stream-codec\"\n                        name=\"codec\"\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\n                        value={currentStream.codec}\n                        onChange={handleInputChange}\n                    >\n                      <option value=\"h264\">H.264</option>\n                      <option value=\"h265\">H.265</option>\n                    </select>\n                  </div>\n                  <div className=\"form-group\">\n                    <label for=\"stream-protocol\" className=\"block text-sm font-medium mb-1\">Protocol</label>\n                    <select\n                        id=\"stream-protocol\"\n                        name=\"protocol\"\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\n                        value={currentStream.protocol}\n                        onChange={handleInputChange}\n                    >\n                      <option value=\"0\">TCP</option>\n                      <option value=\"1\">UDP</option>\n                    </select>\n                    <span className=\"text-xs text-gray-500 dark:text-gray-400\">Connection protocol (ONVIF cameras use either TCP or UDP)</span>\n                  </div>\n                </div>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div className=\"form-group\">\n                    <label for=\"stream-priority\" className=\"block text-sm font-medium mb-1\">Priority</label>\n                    <select\n                        id=\"stream-priority\"\n                        name=\"priority\"\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\n                        value={currentStream.priority}\n                        onChange={handleInputChange}\n                    >\n                      <option value=\"1\">Low (1)</option>\n                      <option value=\"5\">Medium (5)</option>\n                      <option value=\"10\">High (10)</option>\n                    </select>\n                  </div>\n                  <div className=\"form-group\">\n                    <label for=\"stream-segment\" className=\"block text-sm font-medium mb-1\">Segment Duration (seconds)</label>\n                    <input\n                        type=\"number\"\n                        id=\"stream-segment\"\n                        name=\"segment\"\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\n                        min=\"60\"\n                        max=\"3600\"\n                        value={currentStream.segment}\n                        onChange={handleInputChange}\n                    />\n                  </div>\n                </div>\n                <div className=\"form-group flex items-center\">\n                  <input\n                      type=\"checkbox\"\n                      id=\"stream-record\"\n                      name=\"record\"\n                      className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      checked={currentStream.record}\n                      onChange={handleInputChange}\n                  />\n                  <label for=\"stream-record\" className=\"ml-2 block text-sm\">Record</label>\n                </div>\n                <div className=\"form-group flex items-center\">\n                  <input\n                      type=\"checkbox\"\n                      id=\"stream-record-audio\"\n                      name=\"recordAudio\"\n                      className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      checked={currentStream.recordAudio}\n                      onChange={handleInputChange}\n                  />\n                  <label for=\"stream-record-audio\" className=\"ml-2 block text-sm\">Record Audio</label>\n                  <span className=\"ml-2 text-xs text-gray-500 dark:text-gray-400\">Include audio in recordings if available in the stream</span>\n                </div>\n\n                {/* Detection-based recording options */}\n                <div className=\"mt-6 mb-2 pb-1 border-b border-gray-200 dark:border-gray-700\">\n                  <h4 className=\"text-md font-medium\">Detection-Based Recording</h4>\n                </div>\n                <div className=\"form-group flex items-center\">\n                  <input\n                      type=\"checkbox\"\n                      id=\"stream-detection-enabled\"\n                      name=\"detectionEnabled\"\n                      className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      checked={currentStream.detectionEnabled}\n                      onChange={handleInputChange}\n                  />\n                  <label for=\"stream-detection-enabled\" className=\"ml-2 block text-sm\">Enable Detection-Based Recording</label>\n                  <span className=\"ml-2 text-xs text-gray-500 dark:text-gray-400\">Only record when objects are detected</span>\n                </div>\n                <div className=\"form-group\" style={currentStream.detectionEnabled ? '' : 'display: none'}>\n                  <label for=\"stream-detection-model\" className=\"block text-sm font-medium mb-1\">Detection Model</label>\n                  <div className=\"flex space-x-2\">\n                    <select\n                        id=\"stream-detection-model\"\n                        name=\"detectionModel\"\n                        className=\"flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\n                        value={currentStream.detectionModel}\n                        onChange={handleInputChange}\n                    >\n                      <option value=\"\">Select a model</option>\n                      {detectionModels.map(model => (\n                        <option key={model.id} value={model.id}>{model.name}</option>\n                      ))}\n                    </select>\n                    <button\n                        id=\"refresh-models-btn\"\n                        className=\"p-2 rounded-md bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 focus:outline-none\"\n                        title=\"Refresh Models\"\n                        onClick={loadDetectionModels}\n                        type=\"button\"\n                    >\n                      <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path fill-rule=\"evenodd\" d=\"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z\" clip-rule=\"evenodd\"></path>\n                      </svg>\n                    </button>\n                  </div>\n                </div>\n                <div className=\"form-group\" style={currentStream.detectionEnabled ? '' : 'display: none'}>\n                  <label for=\"stream-detection-threshold\" className=\"block text-sm font-medium mb-1\">Detection Threshold</label>\n                  <div className=\"flex items-center space-x-2\">\n                    <input\n                        type=\"range\"\n                        id=\"stream-detection-threshold\"\n                        name=\"detectionThreshold\"\n                        className=\"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700\"\n                        min=\"0\"\n                        max=\"100\"\n                        step=\"1\"\n                        value={currentStream.detectionThreshold}\n                        onInput={handleThresholdChange}\n                    />\n                    <span id=\"stream-threshold-value\" className=\"font-medium text-blue-600 dark:text-blue-400 min-w-[3rem] text-center\">\n                      {currentStream.detectionThreshold}%\n                    </span>\n                  </div>\n                </div>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\" style={currentStream.detectionEnabled ? '' : 'display: none'}>\n                  <div className=\"form-group\">\n                    <label for=\"stream-detection-interval\" className=\"block text-sm font-medium mb-1\">Detection Interval (frames)</label>\n                    <input\n                        type=\"number\"\n                        id=\"stream-detection-interval\"\n                        name=\"detectionInterval\"\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\n                        min=\"1\"\n                        max=\"100\"\n                        value={currentStream.detectionInterval}\n                        onChange={handleInputChange}\n                    />\n                    <span className=\"text-xs text-gray-500 dark:text-gray-400\">Detect on every Nth frame</span>\n                  </div>\n                  <div className=\"form-group\">\n                    <label for=\"stream-pre-buffer\" className=\"block text-sm font-medium mb-1\">Pre-detection Buffer (seconds)</label>\n                    <input\n                        type=\"number\"\n                        id=\"stream-pre-buffer\"\n                        name=\"preBuffer\"\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\n                        min=\"0\"\n                        max=\"60\"\n                        value={currentStream.preBuffer}\n                        onChange={handleInputChange}\n                    />\n                    <span className=\"text-xs text-gray-500 dark:text-gray-400\">Seconds to keep before detection</span>\n                  </div>\n                  <div className=\"form-group\">\n                    <label for=\"stream-post-buffer\" className=\"block text-sm font-medium mb-1\">Post-detection Buffer (seconds)</label>\n                    <input\n                        type=\"number\"\n                        id=\"stream-post-buffer\"\n                        name=\"postBuffer\"\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\n                        min=\"0\"\n                        max=\"300\"\n                        value={currentStream.postBuffer}\n                        onChange={handleInputChange}\n                    />\n                    <span className=\"text-xs text-gray-500 dark:text-gray-400\">Seconds to keep after detection</span>\n                  </div>\n                </div>\n              </form>\n            </div>\n            <div className=\"flex justify-between p-4 border-t border-gray-200 dark:border-gray-700\">\n              <button\n                  id=\"stream-test-btn\"\n                  className=\"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 transition-colors dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600\"\n                  onClick={testStreamConnection}\n                  type=\"button\"\n              >\n                Test Connection\n              </button>\n              <div className=\"space-x-2\">\n                <button\n                    id=\"stream-save-btn\"\n                    className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors\"\n                    onClick={saveStream}\n                    type=\"button\"\n                >\n                  Save\n                </button>\n                <button\n                    id=\"stream-cancel-btn\"\n                    className=\"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors\"\n                    onClick={closeModal}\n                    type=\"button\"\n                >\n                  Cancel\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {onvifModalVisible && (\n        <div id=\"onvif-modal\" className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 transition-opacity duration-300\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto\">\n            <div className=\"flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700\">\n              <h3 className=\"text-lg font-medium\">ONVIF Camera Discovery</h3>\n              <span className=\"text-2xl cursor-pointer\" onClick={() => setOnvifModalVisible(false)}>×</span>\n            </div>\n            <div className=\"p-4\">\n              <div className=\"mb-4 flex justify-between items-center\">\n                <h4 className=\"text-md font-medium\">Discovered Devices</h4>\n                <button\n                    id=\"discover-btn\"\n                    className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors focus:outline-none\"\n                    onClick={startOnvifDiscovery}\n                    disabled={isDiscovering}\n                    type=\"button\"\n                >\n                  {isDiscovering ? (\n                    <span className=\"flex items-center\">\n                      Discovering\n                      <span className=\"ml-1 flex space-x-1\">\n                        <span className=\"animate-pulse delay-0 h-1.5 w-1.5 bg-white rounded-full\"></span>\n                        <span className=\"animate-pulse delay-150 h-1.5 w-1.5 bg-white rounded-full\"></span>\n                        <span className=\"animate-pulse delay-300 h-1.5 w-1.5 bg-white rounded-full\"></span>\n                      </span>\n                    </span>\n                  ) : 'Start Discovery'}\n                </button>\n              </div>\n\n              <div className=\"overflow-x-auto\">\n                <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                  <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                  <tr>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">IP Address</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Manufacturer</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Model</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Actions</th>\n                  </tr>\n                  </thead>\n                  <tbody className=\"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700\">\n                  {discoveredDevices.length === 0 ? (\n                    <tr>\n                      <td colSpan=\"4\" className=\"px-6 py-4 text-center text-gray-500 dark:text-gray-400\">\n                        {isDiscovering ? (\n                          <div className=\"flex items-center justify-center\">\n                            <span>Discovering devices</span>\n                            <span className=\"ml-1 flex space-x-1\">\n                                <span className=\"animate-pulse delay-0 h-1.5 w-1.5 bg-gray-500 dark:bg-gray-400 rounded-full\"></span>\n                                <span className=\"animate-pulse delay-150 h-1.5 w-1.5 bg-gray-500 dark:bg-gray-400 rounded-full\"></span>\n                                <span className=\"animate-pulse delay-300 h-1.5 w-1.5 bg-gray-500 dark:bg-gray-400 rounded-full\"></span>\n                              </span>\n                          </div>\n                        ) : 'No devices discovered yet. Click \"Start Discovery\" to scan your network.'}\n                      </td>\n                    </tr>\n                  ) : discoveredDevices.map(device => (\n                    <tr key={device.ip_address} className=\"hover:bg-gray-50 dark:hover:bg-gray-700\">\n                      <td className=\"px-6 py-4 whitespace-nowrap\">{device.ip_address}</td>\n                      <td className=\"px-6 py-4 whitespace-nowrap\">{device.manufacturer || 'Unknown'}</td>\n                      <td className=\"px-6 py-4 whitespace-nowrap\">{device.model || 'Unknown'}</td>\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <button\n                            className=\"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors focus:outline-none\"\n                            onClick={() => testOnvifConnection(device)}\n                            disabled={isLoadingProfiles && selectedDevice && selectedDevice.ip_address === device.ip_address}\n                            type=\"button\"\n                        >\n                          {isLoadingProfiles && selectedDevice && selectedDevice.ip_address === device.ip_address ? (\n                            <span className=\"flex items-center\">\n                                Loading\n                                <span className=\"ml-1 flex space-x-1\">\n                                  <span className=\"animate-pulse delay-0 h-1.5 w-1.5 bg-white rounded-full\"></span>\n                                  <span className=\"animate-pulse delay-150 h-1.5 w-1.5 bg-white rounded-full\"></span>\n                                  <span className=\"animate-pulse delay-300 h-1.5 w-1.5 bg-white rounded-full\"></span>\n                                </span>\n                              </span>\n                          ) : 'Connect'}\n                        </button>\n                      </td>\n                    </tr>\n                  ))}\n                  </tbody>\n                </table>\n              </div>\n\n              <div className=\"mt-6 mb-4\">\n                <h4 className=\"text-md font-medium mb-2\">Authentication</h4>\n                <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-3\">\n                  Enter credentials to connect to the selected ONVIF device. Credentials are not needed for discovery, only for connecting to devices.\n                </p>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div className=\"form-group\">\n                    <label for=\"onvif-username\" className=\"block text-sm font-medium mb-1\">Username</label>\n                    <input\n                        type=\"text\"\n                        id=\"onvif-username\"\n                        name=\"username\"\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\n                        placeholder=\"admin\"\n                        value={onvifCredentials.username}\n                        onChange={handleCredentialChange}\n                    />\n                  </div>\n                  <div className=\"form-group\">\n                    <label for=\"onvif-password\" className=\"block text-sm font-medium mb-1\">Password</label>\n                    <input\n                        type=\"password\"\n                        id=\"onvif-password\"\n                        name=\"password\"\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\n                        placeholder=\"password\"\n                        value={onvifCredentials.password}\n                        onChange={handleCredentialChange}\n                    />\n                  </div>\n                </div>\n              </div>\n\n              {selectedDevice && deviceProfiles.length > 0 && (\n                <div className=\"mt-6\">\n                  <h4 className=\"text-md font-medium mb-2\">Available Profiles for {selectedDevice.ip_address}</h4>\n                  <div className=\"overflow-x-auto\">\n                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                      <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                      <tr>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Name</th>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Resolution</th>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Encoding</th>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">FPS</th>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Actions</th>\n                      </tr>\n                      </thead>\n                      <tbody className=\"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700\">\n                      {deviceProfiles.map(profile => (\n                        <tr key={profile.token} className=\"hover:bg-gray-50 dark:hover:bg-gray-700\">\n                          <td className=\"px-6 py-4 whitespace-nowrap\">{profile.name}</td>\n                          <td className=\"px-6 py-4 whitespace-nowrap\">{profile.width}x{profile.height}</td>\n                          <td className=\"px-6 py-4 whitespace-nowrap\">{profile.encoding}</td>\n                          <td className=\"px-6 py-4 whitespace-nowrap\">{profile.fps}</td>\n                          <td className=\"px-6 py-4 whitespace-nowrap\">\n                            <button\n                                className=\"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 transition-colors focus:outline-none\"\n                                onClick={() => addOnvifDeviceAsStream(profile)}\n                                type=\"button\"\n                            >\n                              Add as Stream\n                            </button>\n                          </td>\n                        </tr>\n                      ))}\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n            )}\n            </div>\n            <div className=\"flex justify-end p-4 border-t border-gray-200 dark:border-gray-700\">\n              <button\n                  id=\"onvif-close-btn\"\n                  className=\"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors\"\n                  onClick={() => setOnvifModalVisible(false)}\n                  type=\"button\"\n              >\n                Close\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {showCustomNameInput && (\n        <div id=\"custom-name-modal\" className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 transition-opacity duration-300\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full\">\n            <div className=\"flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700\">\n              <h3 className=\"text-lg font-medium\">Stream Name</h3>\n              <span className=\"text-2xl cursor-pointer\" onClick={() => setShowCustomNameInput(false)}>×</span>\n            </div>\n            <div className=\"p-4\">\n              <div className=\"mb-4\">\n                <label for=\"custom-stream-name\" className=\"block text-sm font-medium mb-1\">Enter a name for this stream:</label>\n                <input\n                    type=\"text\"\n                    id=\"custom-stream-name\"\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\n                    value={customStreamName}\n                    onChange={(e) => setCustomStreamName(e.target.value)}\n                />\n                <p className=\"mt-1 text-sm text-gray-500 dark:text-gray-400\">\n                  This name will be used to identify the stream in the system.\n                </p>\n              </div>\n            </div>\n            <div className=\"flex justify-end p-4 border-t border-gray-200 dark:border-gray-700 space-x-2\">\n              <button\n                  className=\"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors\"\n                  onClick={() => setShowCustomNameInput(false)}\n                  type=\"button\"\n              >\n                Cancel\n              </button>\n              <button\n                  className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors\"\n                  onClick={submitOnvifDevice}\n                  type=\"button\"\n                  disabled={!customStreamName.trim() || isAddingStream}\n              >\n                {isAddingStream ? (\n                  <span className=\"flex items-center\">\n                    Adding\n                    <span className=\"ml-1 flex space-x-1\">\n                      <span className=\"animate-pulse delay-0 h-1.5 w-1.5 bg-white rounded-full\"></span>\n                      <span className=\"animate-pulse delay-150 h-1.5 w-1.5 bg-white rounded-full\"></span>\n                      <span className=\"animate-pulse delay-300 h-1.5 w-1.5 bg-white rounded-full\"></span>\n                    </span>\n                  </span>\n                ) : 'Add Stream'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </section>\n  );\n}\n","/**\n * LightNVR Web Interface Streams Page\n * Entry point for the streams page\n */\n\nimport { render } from 'preact';\nimport { StreamsView } from '../components/preact/StreamsView.jsx';\nimport { QueryClientProvider, queryClient } from '../query-client.js';\nimport {Header} from \"../components/preact/Header.jsx\";\nimport {Footer} from \"../components/preact/Footer.jsx\";\n\n// Render the StreamsView component when the DOM is loaded\ndocument.addEventListener('DOMContentLoaded', () => {\n  // Get the container element\n  const container = document.getElementById('main-content');\n\n  if (container) {\n    render(\n      <QueryClientProvider client={queryClient}>\n        <Header />\n        <StreamsView />\n        <Footer />\n      </QueryClientProvider>,\n      container\n    );\n  }\n});\n"],"names":["StreamDeleteModal","streamId","streamName","onClose","onDisable","onDelete","isConfirmDelete","setIsConfirmDelete","useState","showDeleteConfirmation","handleDisable","handleDelete","html","_c","__template","_b","_a","StreamsView","queryClient","useQueryClient","modalVisible","setModalVisible","onvifModalVisible","setOnvifModalVisible","showCustomNameInput","setShowCustomNameInput","isAddingStream","setIsAddingStream","discoveredDevices","setDiscoveredDevices","deviceProfiles","setDeviceProfiles","selectedDevice","setSelectedDevice","selectedProfile","setSelectedProfile","customStreamName","setCustomStreamName","onvifCredentials","setOnvifCredentials","isDiscovering","setIsDiscovering","isLoadingProfiles","setIsLoadingProfiles","streamsResponse","isLoading","error","useQuery","detectionModelsData","streams","currentStream","setCurrentStream","isEditing","setIsEditing","deleteModalVisible","setDeleteModalVisible","streamToDelete","setStreamToDelete","hasData","detectionModels","createStreamMutation","usePostMutation","showStatusMessage","closeModal","updateStreamMutation","useMutation","data","streamData","url","fetchJSON","saveStreamMutation","options","testStreamMutation","deleteStreamMutation","params","closeDeleteModal","disableStreamMutation","handleSubmit","e","saveStream","testStreamConnection","openDeleteModal","stream","openAddStreamModal","openEditStreamModal","response","handleInputChange","name","value","type","checked","prev","disableStream","deleteStream","handleCredentialChange","handleThresholdChange","loadDetectionModels","onvifDiscoveryMutation","getDeviceProfilesMutation","device","credentials","testOnvifConnectionMutation","variables","getDeviceProfiles","submitOnvifDevice","startOnvifDiscovery","addOnvifDeviceAsStream","profile","testOnvifConnection","jsxs","jsx","ContentLoader","model","container","render","QueryClientProvider","Header","Footer"],"mappings":"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"}